<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<title>ホーム画面</title>
	<link rel="stylesheet" th:href="@{/css/home.css}">
	<link rel="stylesheet" th:href="@{/css/common/header.css}">
</head>

<body>
	<header class="hidden" th:replace="~{html/common/header :: layout-header}"></header>

	<!-- 固定ナビゲーションボタン（ページ最上部でのみ表示） -->
	<nav id="fixed-nav" class="fixed-nav">
		<a th:href="@{/card/list}" class="fixed-nav-link">カードリスト</a>
		<a th:href="@{/choice/leader}" class="fixed-nav-link">デッキ作成</a>
		<a th:href="@{/deck/list}" class="fixed-nav-link">デッキ一覧</a>
		<a th:href="@{/setting}" class="fixed-nav-link">設定</a>
		<a th:if="${session.role} == 'admin'" th:href="@{/admin/config}" class="fixed-nav-link admin-link">管理者設定</a>
	</nav>

	<!-- スプラッシュ -->
	<section id="splash-section">
		<div id="splash-content">
			<img th:src="@{/img/onepiececard_logo.png}" id="splash-logo">
		</div>
	</section>

	<main>
		<!-- ホーム画面（最初は非表示） -->
		<section id="home-section" class="hidden">
			<div class="background-section section-1"></div>
			<div class="background-section section-2"></div>
		</section>
	</main>

	<script>
		document.addEventListener("DOMContentLoaded", () => {
			const header = document.querySelector("header");
			const fixedNav = document.getElementById("fixed-nav");
			const scrollThreshold = 50;

			// スプラッシュ表示中はスクロールを無効化
			document.body.style.overflow = "hidden";

			// ロゴのアニメーションが終わるころに実行（3秒に延長）
			setTimeout(() => {
				const splash = document.getElementById("splash-section");
				const home = document.getElementById("home-section");

				// スプラッシュ画面をフェードアウト
				splash.style.opacity = "0";
				splash.style.transition = "opacity 0.5s ease";

				// スプラッシュ画面を完全に非表示にしてからホーム画面を表示
				setTimeout(() => {
					splash.style.display = "none";

					// スクロールを再度有効化
					document.body.style.overflow = "auto";

					// ヘッダーを表示可能にする（最初は非表示状態）
					if (header) {
						header.classList.remove("hidden");
						header.classList.add("header-hidden");
					}
					home.classList.remove("hidden");

					// 固定ナビゲーションを表示
					console.log("Fixed nav element:", fixedNav);
					if (fixedNav) {
						fixedNav.classList.add("show");
						console.log("Fixed nav classes:", fixedNav.classList);
					}

					// 次のタイミングでホーム画面をフェードイン
					setTimeout(() => {
						home.classList.add("show");
					}, 10);
				}, 500);

			}, 3000);

			// スクロールに応じてヘッダーと固定ナビゲーションの表示/非表示を切り替え
			window.addEventListener("scroll", () => {
				const scrollTop = window.pageYOffset || document.documentElement.scrollTop;

				if (scrollTop <= scrollThreshold) {
					// 最上部付近ではヘッダーを非表示、固定ナビゲーションを表示
					if (header) {
						header.classList.add("header-hidden");
					}
					if (fixedNav) {
						fixedNav.classList.add("show");
					}
				} else {
					// スクロールしたらヘッダーを表示、固定ナビゲーションを非表示
					if (header) {
						header.classList.remove("header-hidden");
					}
					if (fixedNav) {
						fixedNav.classList.remove("show");
					}
				}
			});
		});
	</script>
</body>

</html>